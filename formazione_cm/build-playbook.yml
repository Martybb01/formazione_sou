- name: Build Docker images and run containers
  hosts: local
  become: false
  tasks:
    - name: Build Alpine image
      community.docker.docker_image:
        name: alpine:ssh-v1
        build:
          path: ./alpine
        source: build
    
    - name: Run alpine container
      community.docker.docker_container:
        name: alpine-ssh
        image: alpine:ssh-v1
        state: started
        restart_policy: always
        ports:
          - "4200:22"
        
    - name: Build Rocky image
      community.docker.docker_image:
        name: rocky:ssh-v1
        build:
          path: ./rocky
        source: build

    - name: Run rocky container
      community.docker.docker_container:
        name: rocky-ssh
        image: rocky:ssh-v1
        state: started
        restart_policy: always
        ports:
          - "4201:22"
